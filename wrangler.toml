name = "fastfile"
main = "src/index-r2.js"
compatibility_date = "2024-01-01"

# CPU时间限制: 5分钟
# 足够处理10GB文件的压缩（预计需要约1.2-2.3分钟）
limits = { cpu_ms = 300000 }

# KV命名空间用于存储文件元数据
[[kv_namespaces]]
binding = "FILE_META"
id = "eebe6705cd794ffea868aeea3954658c"

# R2存储桶用于存储文件
[[r2_buckets]]
binding = "FILE_STORAGE"
bucket_name = "fastfile-storage"

# R2 API凭证 (需要配置secrets)
# 运行以下命令设置secrets:
# wrangler secret put R2_ACCOUNT_ID
# wrangler secret put R2_ACCESS_KEY_ID
# wrangler secret put R2_SECRET_ACCESS_KEY
# wrangler secret put R2_BUCKET_NAME

# 定时任务用于清理过期文件
[triggers]
crons = ["0 0 * * *"]  # 每天00:00执行清理任务

# 自定义域名配置
routes = [
  { pattern = "file.zwi.monster/*", zone_name = "zwi.monster" }
]

